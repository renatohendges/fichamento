<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
>
<ui:composition>
	<h1>Livros</h1>
	<p:panelGrid
		id="panelGridLivro"
		columns="2"
		styleClass="ui-noborder"
		style="text-align:right"
	>
		<p:panelGrid
			id="panelGridLivroInterna1"
			columns="2"
			styleClass="ui-noborder"
			style="text-align:right"
		>
			<p:outputLabel
				id="outputLabelTitulo"
				for="inputTextTitulo"
				value="Título:"
			/>
			<p:inputText
				id="inputTextTitulo"
				value="#{controladorLivro.livro.titulo}"
				readonly="#{!controladorLivro.adicionando and !controladorLivro.editando}"
				style="background:#{controladorLivro.alterarFundoInputText()}"
			/>
			<p:outputLabel
				id="outputLabelSubTitulo"
				for="inputTextSubTitulo"
				value="Sub Título:"
			/>
			<p:inputText
				id="inputTextSubTitulo"
				value="#{controladorLivro.livro.subTitulo}"
				readonly="#{!controladorLivro.adicionando and !controladorLivro.editando}"
				style="background:#{controladorLivro.alterarFundoInputText()}"
			/>
			<p:outputLabel
				id="outputLabelAutor"
				for="inputTextAutor"
				value="Autor:"
			/>
			<p:inputText
				id="inputTextAutor"
				value="#{controladorLivro.livro.autor}"
				readonly="#{!controladorLivro.adicionando and !controladorLivro.editando}"
				style="background:#{controladorLivro.alterarFundoInputText()}"
			/>
			<p:outputLabel
				id="outputLabelIsbn"
				for="inputTextIsbn"
				value="Isbn:"
			/>
			<p:inputText
				id="inputTextIsbn"
				value="#{controladorLivro.livro.isbn}"
				readonly="#{!controladorLivro.adicionando and !controladorLivro.editando}"
				style="background:#{controladorLivro.alterarFundoInputText()}"
			/>
		</p:panelGrid>
		<p:panelGrid
			id="panelGridLivroInterna2"
			columns="2"
			styleClass="ui-noborder"
			style="text-align:right"
		>
			<p:outputLabel
				id="outputLabelEdicao"
				for="inputTextEdicao"
				value="Edição:"
			/>
			<p:inputText
				id="inputTextEdicao"
				value="#{controladorLivro.livro.edicao}"
				readonly="#{!controladorLivro.adicionando and !controladorLivro.editando}"
				style="background:#{controladorLivro.alterarFundoInputText()}"
			/>
			<p:outputLabel
				id="outputLabelCidadePublicacao"
				for="inputTextCidadePublicacao"
				value="Cidade de Publicação:"
			/>
			<p:inputText
				id="inputTextCidadePublicacao"
				value="#{controladorLivro.livro.cidadePublicacao}"
				readonly="#{!controladorLivro.adicionando and !controladorLivro.editando}"
				style="background:#{controladorLivro.alterarFundoInputText()}"
			/>
			<p:outputLabel
				id="outputLabelEditora"
				for="inputTextEditora"
				value="Editora:"
			/>
			<p:inputText
				id="inputTextEditora"
				value="#{controladorLivro.livro.editora}"
				readonly="#{!controladorLivro.adicionando and !controladorLivro.editando}"
				style="background:#{controladorLivro.alterarFundoInputText()}"
			/>
			<p:outputLabel
				id="outputLabelAnoPublicacao"
				for="inputTextAnoPublicacao"
				value="Ano Publicação:"
			/>
			<p:inputText
				id="inputTextAnoPublicacao"
				value="#{controladorLivro.livro.anoPublicacao}"
				readonly="#{!controladorLivro.adicionando and !controladorLivro.editando}"
				style="background:#{controladorLivro.alterarFundoInputText()}"
			/>
		</p:panelGrid>
	</p:panelGrid>
	<p:panelGrid
		id="panelGridLivroBotoes"
		columns="5"
		styleClass="ui-noborder"
		style="text-align:right"
	>
		<p:commandButton
			id="commandButtonLivrosAdicionar"
			value="Adicionar"
			actionListener="#{controladorLivro.adicionarLivro()}"
			update="dataTableLivros panelGridLivroBotoes panelGridLivro"
			immediate="true"
			disabled="#{controladorLivro.editandoAdicionando()}"
			oncomplete="PF('dataTableLivros').unselectAllRows()"
		/>
		<p:commandButton
			id="commandButtonLivrosEditar"
			value="Editar"
			actionListener="#{controladorLivro.editar()}"
			update="dataTableLivros panelGridLivroBotoes panelGridLivro"
			disabled="#{empty controladorLivro.livroSelecionado}"
			rendered="#{controladorAcesso.usuario.administrador}"
		/>
		<p:commandButton
			id="commandButtonLivrosSalvar"
			value="Salvar"
			actionListener="#{controladorLivro.salvarLivro()}"
			update="dataTableLivros panelGridLivroBotoes panelGridLivro growl"
			disabled="#{!controladorLivro.editandoAdicionando()}"
		/>
		<p:commandButton
			id="commandButtonLivrosCancelar"
			value="Cancelar"
			actionListener="#{controladorLivro.cancelar()}"
			update="dataTableLivros panelGridLivroBotoes panelGridLivro"
			disabled="#{!controladorLivro.editandoAdicionando()}"
			oncomplete="PF('dataTableLivros').unselectAllRows()"
			process="@this"
		/>
		<p:commandButton
			id="commandButtonLivrosFichar"
			value="Fichar"
			update="panelConteudo"
			disabled="#{controladorLivro.editando or empty controladorLivro.livroSelecionado}"
			oncomplete="PF('dataTableLivros').unselectAllRows()"
			process="@this"
			style="background: lightgreen;"
		/>
	</p:panelGrid>
	<p:dataTable
		id="dataTableLivros"
		widgetVar="dataTableLivros"
		value="#{controladorLivro.livros}"
		var="livro"
		selectionMode="single"
		selection="#{controladorLivro.livroSelecionado}"
		rowKey="#{livro.id}"
		rows="5"
		disabledSelection="#{controladorLivro.editandoAdicionando()}"
		sortBy="#{livro.titulo}"
		filteredValue="#{controladorLivro.livrosFiltrados}"
		emptyMessage="Lista vazia"
		paginator="true"
		paginatorPosition="top"
		lazy="true"
	>
		<p:column
			headerText="ISBN"
			filterBy="#{livro.isbn}"
			filterMatchMode="contains"
			style="width:120px;text-align:center;"
		>
			<h:outputText value="#{livro.isbn}" />
		</p:column>
		<p:column
			headerText="Título"
			filterBy="#{livro.titulo}"
			filterMatchMode="contains"
		>
			<h:outputText value="#{livro.titulo}" />
		</p:column>
		<p:column
			headerText="Fichas Criadas"
			style="width:70px;text-align:center;"
		>
			<p:commandLink
				id="commandLinkQuantidadeFichas"
				value="#{livro.quantidadeFichas}"
			/>
			<p:tooltip
				id="tooltipQuantidadeFichas"
				for="commandLinkQuantidadeFichas"
				value="Ver fichas criadas para o livro"
				showEffect="pulsate"
				hideEffect="clip"
			/>
		</p:column>
		<p:ajax
			event="rowSelect"
			update=":formConteudo:panelGridLivro :formConteudo:panelGridLivroBotoes"
			listener="#{controladorLivro.verLivro()}"
		/>
	</p:dataTable>
	<p:dialog
		id="dialogFichasCriadas"
		widgetVar="dialogFichasCriadas"
		closeOnEscape="true"
		modal="true"
		resizable="false"
	>
		<p:dataTable
			id="dataTableFichasCriadas"
			widgetVar="dataTableFichasCriadas"
			value="#{controladorFicha.fichasPorLivro}"
		></p:dataTable>
	</p:dialog>
</ui:composition>
</html>
